<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Estimate a colBiSBM on a collection of networks — estimate_colBiSBM • colSBM</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimate a colBiSBM on a collection of networks — estimate_colBiSBM"><meta name="description" content="Estimate a colBiSBM on a collection of networks"><meta property="og:description" content="Estimate a colBiSBM on a collection of networks"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">colSBM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/tutorial-bipartite.html">Tutorial on plant pollinator data</a></li>
    <li><a class="dropdown-item" href="../articles/tutorial.html">Tutorial on food webs</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Estimate a colBiSBM on a collection of networks</h1>

      <div class="d-none name"><code>estimate_colBiSBM.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Estimate a colBiSBM on a collection of networks</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">estimate_colBiSBM</span><span class="op">(</span></span>
<span>  <span class="va">netlist</span>,</span>
<span>  <span class="va">colsbm_model</span>,</span>
<span>  net_id <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  distribution <span class="op">=</span> <span class="st">"bernoulli"</span>,</span>
<span>  nb_run <span class="op">=</span> <span class="fl">3L</span>,</span>
<span>  global_opts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  fit_opts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  Z_init <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sep_BiSBM <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-netlist">netlist<a class="anchor" aria-label="anchor" href="#arg-netlist"></a></dt>
<dd><p>A list of matrices.</p></dd>


<dt id="arg-colsbm-model">colsbm_model<a class="anchor" aria-label="anchor" href="#arg-colsbm-model"></a></dt>
<dd><p>Which colBiSBM to use, one of "iid", "pi", "rho",
"pirho".</p></dd>


<dt id="arg-net-id">net_id<a class="anchor" aria-label="anchor" href="#arg-net-id"></a></dt>
<dd><p>A vector of string, the name of the networks.</p></dd>


<dt id="arg-distribution">distribution<a class="anchor" aria-label="anchor" href="#arg-distribution"></a></dt>
<dd><p>A string, the emission distribution, either "bernoulli"
(the default) or "poisson".</p></dd>


<dt id="arg-nb-run">nb_run<a class="anchor" aria-label="anchor" href="#arg-nb-run"></a></dt>
<dd><p>An integer, the number of run the algorithm do. Default to 3.</p></dd>


<dt id="arg-global-opts">global_opts<a class="anchor" aria-label="anchor" href="#arg-global-opts"></a></dt>
<dd><p>Global options for the outer algorithm and the output.
See details.</p></dd>


<dt id="arg-fit-opts">fit_opts<a class="anchor" aria-label="anchor" href="#arg-fit-opts"></a></dt>
<dd><p>Fit options for the VEM algorithm. See details</p></dd>


<dt id="arg-z-init">Z_init<a class="anchor" aria-label="anchor" href="#arg-z-init"></a></dt>
<dd><p>An optional bi-dimensional list of size <code>Q1_max</code> x <code>Q2_max</code> containing
for each value a list of two vectors of clusters memberships. Default to
NULL.</p></dd>


<dt id="arg-sep-bisbm">sep_BiSBM<a class="anchor" aria-label="anchor" href="#arg-sep-bisbm"></a></dt>
<dd><p>A pre-fitted <code>sep_BiSBM.</code> Used to avoid end computations. The
best way to obtain one is to extract from a fitted bisbmpop object. Defaults
to NULL.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A bisbmpop object listing a collection of models for the collection.
of networks</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The list of parameters <code>global_opts</code> essentially tunes the
exploration process.</p><ul><li><p><code>nb_cores</code> integer for number of cores used for
parallelization. Default is 1</p></li>
<li><p><code>verbosity</code> integer for verbosity (0, 1, 2, 3, 4). Default is 1.
0 will disable completely the output of the function. Note: you
can access the $joint_modelisation_preferred attribute to check which
modelisation is preferred</p></li>
<li><p><code>Q1_max</code> integer for the max size in row to explore. Default is
computed with the following formula:
<code>floor(log(sum(sapply(netlist, function(A) nrow(A)))) + 2)</code></p></li>
<li><p><code>Q2_max</code> integer for the max size in columns to explore. Default is
computed with the following formula:
<code>floor(log(sum(sapply(netlist, function(A) ncol(A)))) + 2)</code></p></li>
<li><p><code>nb_models</code> the number of models to keep for each values of Q1,Q2.
Default is 5.</p></li>
<li><p><code>depth</code> specifies how large will the moving window be. Default is 1,
meaning the window will go from (Q1 - 1, Q2 - 1) to (Q1 + 1, Q2 + 1) and all
the values in the square defined.</p></li>
<li><p><code>plot_details</code> integer to control the display of the exploration and
moving window process. Values are 0 or 1. Default is 1.</p></li>
<li><p><code>max_pass</code> the maximum number of moving window passes that will be
executed. Default is 10.</p></li>
</ul><p>The list of parameters <code>fit_opts</code> are used to tune the Variational
Expectation Maximization algorithm.</p><ul><li><p><code>algo_ve</code> a string to choose the algorithm to use for the variational
estimation. Available: "fp"</p></li>
<li><p><code>verbosity</code> an integer to choose the level of verbosity of the fit
procedure. Defaults to 0. Available: 0,1</p></li>
<li><p><code>max_vem_steps</code> an integer setting the number of Variational
Expectation-Maximization steps to perform. Defaults to 1000.</p></li>
<li><p><code>minibatch</code> a boolean setting wether to use a "minibatch" like
approach. If set to TRUE during the VEM the networks will be optimized in
random orders. If set to FALSE they are optimized in the lexicographical
order. Default to TRUE.</p></li>
<li><p><code>tolerance</code> a numeric, controlling the tolerance for which a criterion is
considered converged. Default to 1e-6.</p></li>
<li><p><code>greedy_exploration_max_steps</code> the maximum number of iteration of
greedy exploration to perform. Defaults to 50.</p></li>
<li><p><code>greedy_exploration_max_steps_without_improvement</code> an integer indicating
for which number of steps the best model must not change to be end greedy
exploration. Defaults to 5.</p></li>
<li><p><code>kmeans_nstart</code> an integer indicating the number of random starts to use for
kmeans in spectral clustering.</p></li>
<li><p><code>kmeans_iter_max</code> an integer indicating the maximum number of iterations to
use for kmeans in spectral clustering.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="clusterize_bipartite_networks.html">clusterize_bipartite_networks()</a></code>, <code><a href="bisbmpop.html">bisbmpop</a></code>,
<code><a href="fitBipartiteSBMPop.html">fitBipartiteSBMPop</a></code>, <code>browseVignettes("colSBM")</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">alpha1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.7</span><span class="op">)</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">alpha2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.2</span><span class="op">)</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">first_collection</span> <span class="op">&lt;-</span> <span class="fu"><a href="generate_bipartite_collection.html">generate_bipartite_collection</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  nr <span class="op">=</span> <span class="fl">50</span>, nc <span class="op">=</span> <span class="fl">25</span>,</span></span>
<span class="r-in"><span>  pi <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.5</span><span class="op">)</span>, rho <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.5</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="va">alpha1</span>, M <span class="op">=</span> <span class="fl">2</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">second_collection</span> <span class="op">&lt;-</span> <span class="fu"><a href="generate_bipartite_collection.html">generate_bipartite_collection</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  nr <span class="op">=</span> <span class="fl">50</span>, nc <span class="op">=</span> <span class="fl">25</span>,</span></span>
<span class="r-in"><span>  pi <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.5</span><span class="op">)</span>, rho <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.5</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="va">alpha2</span>, M <span class="op">=</span> <span class="fl">2</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">netlist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="va">first_collection</span>, <span class="va">second_collection</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># A collection where joint modelisation makes sense</span></span></span>
<span class="r-in"><span><span class="va">cl_joint</span> <span class="op">&lt;-</span> <span class="fu">estimate_colBiSBM</span><span class="op">(</span></span></span>
<span class="r-in"><span>  netlist <span class="op">=</span> <span class="va">first_collection</span>,</span></span>
<span class="r-in"><span>  colsbm_model <span class="op">=</span> <span class="st">"iid"</span>,</span></span>
<span class="r-in"><span>  global_opts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>nb_cores <span class="op">=</span> <span class="fu">parallelly</span><span class="fu">::</span><span class="fu"><a href="https://parallelly.futureverse.org/reference/availableCores.html" class="external-link">availableCores</a></span><span class="op">(</span>omit <span class="op">=</span> <span class="fl">1L</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># A collection where joint modelisation doesn't make sense</span></span></span>
<span class="r-in"><span><span class="va">cl_separated</span> <span class="op">&lt;-</span> <span class="fu">estimate_colBiSBM</span><span class="op">(</span></span></span>
<span class="r-in"><span>  netlist <span class="op">=</span> <span class="va">netlist</span>,</span></span>
<span class="r-in"><span>  colsbm_model <span class="op">=</span> <span class="st">"iid"</span>,</span></span>
<span class="r-in"><span>  global_opts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>nb_cores <span class="op">=</span> <span class="fu">parallelly</span><span class="fu">::</span><span class="fu"><a href="https://parallelly.futureverse.org/reference/availableCores.html" class="external-link">availableCores</a></span><span class="op">(</span>omit <span class="op">=</span> <span class="fl">1L</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Saint-Clair Chabert-Liddell, Louis Lacoste.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>

