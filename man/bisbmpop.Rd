% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/R6class-bisbmpop.R
\name{bisbmpop}
\alias{bisbmpop}
\title{An R6 Class object, a collection of model for population of BiSBM networks}
\description{
This object contain all the logic and methods to estimate a colBiSBM model
}
\section{Public fields}{
\if{html}{\out{<div class="r6-fields">}}
\describe{
\item{\code{n}}{A list with two dimensions, each of size M for the rows and cols}

\item{\code{A}}{List of incidence Matrix of size \verb{n[[1]][m]xn[[2]][m]}}

\item{\code{M}}{Number of networks}

\item{\code{mask}}{List of M masks, indicating NAs in the matrices. 1 for NA, 0 else}

\item{\code{distribution}}{Emission distribution either : "poisson" or
"bernoulli"}

\item{\code{net_id}}{A vector containing the "ids" or names of the networks
(if none given, they are set to their number in A list)}

\item{\code{model_list}}{A list of size Q1max * Q2max containing the best models}

\item{\code{discarded_model_list}}{A list of size
Q1max * Q2max * (nb_models - 1) containing
the discarded models.}

\item{\code{global_opts}}{A list of options for the model space exploration.
See details for more information on which options are available.}

\item{\code{fit_opts}}{A list of options specifically for fitting the models.}

\item{\code{separated_inits}}{A nested list : Q1 init containing Q2 init
with each entry containing list of size M
storing the separated inits for the class.}

\item{\code{exploration_order_list}}{A list used to store the path taken
in the state space.}

\item{\code{Z_init}}{A list of initializations for the Z memberships.}

\item{\code{free_density}}{TODO remove}

\item{\code{free_mixture_row}}{A boolean signaling if there is free mixture on
the row blocks}

\item{\code{free_mixture_col}}{A boolean signaling if there is free mixture on
the columns blocks}

\item{\code{ICL}}{A matrix of size Q1*Q2 storing the best ICL found for each
value of Q1, Q2.}

\item{\code{sep_BiSBM}}{A named list containing attributes for each sep BiSBM.}

\item{\code{BICL}}{A matrix of size Q1*Q2 storing the best BICL found for each
value of Q1, Q2.}

\item{\code{vbound}}{A matrix of size Q1*Q2 storing the best vbound found for each
value of Q1, Q2.}

\item{\code{best_fit}}{A fitBipartiteSBMPop object changing regularly to store
the current best fit.}

\item{\code{adjusted_fit}}{Defining a field in case the user wants to adjust a
prefitted bisbmpop.}

\item{\code{logfactA}}{A quantity used with the Poisson probability distribution}

\item{\code{improved}}{A field use at each step to check if it has improved.}

\item{\code{moving_window_coordinates}}{A list of size two containing the
coordinates of the bottom left and top
right points of the square}

\item{\code{old_moving_window_coordinates}}{A list containing the previous
coordinates of the moving window.}

\item{\code{joint_modelisation_preferred}}{A boolean to store the preferred
modelisation.}
}
\if{html}{\out{</div>}}
}
\section{Methods}{
\subsection{Public methods}{
\itemize{
\item \href{#method-bisbmpop-new}{\code{bisbmpop$new()}}
\item \href{#method-bisbmpop-split_clustering}{\code{bisbmpop$split_clustering()}}
\item \href{#method-bisbmpop-merge_clustering}{\code{bisbmpop$merge_clustering()}}
\item \href{#method-bisbmpop-state_space_plot}{\code{bisbmpop$state_space_plot()}}
\item \href{#method-bisbmpop-greedy_exploration}{\code{bisbmpop$greedy_exploration()}}
\item \href{#method-bisbmpop-optimize_from_zinit}{\code{bisbmpop$optimize_from_zinit()}}
\item \href{#method-bisbmpop-burn_in}{\code{bisbmpop$burn_in()}}
\item \href{#method-bisbmpop-optimize}{\code{bisbmpop$optimize()}}
\item \href{#method-bisbmpop-moving_window}{\code{bisbmpop$moving_window()}}
\item \href{#method-bisbmpop-truncate_discarded_model_list}{\code{bisbmpop$truncate_discarded_model_list()}}
\item \href{#method-bisbmpop-point_is_in_limits}{\code{bisbmpop$point_is_in_limits()}}
\item \href{#method-bisbmpop-store_criteria_and_best_fit}{\code{bisbmpop$store_criteria_and_best_fit()}}
\item \href{#method-bisbmpop-compute_sep_BiSBM_BICL}{\code{bisbmpop$compute_sep_BiSBM_BICL()}}
\item \href{#method-bisbmpop-choose_joint_or_separated}{\code{bisbmpop$choose_joint_or_separated()}}
\item \href{#method-bisbmpop-plot}{\code{bisbmpop$plot()}}
\item \href{#method-bisbmpop-print_metrics}{\code{bisbmpop$print_metrics()}}
\item \href{#method-bisbmpop-show}{\code{bisbmpop$show()}}
\item \href{#method-bisbmpop-print}{\code{bisbmpop$print()}}
\item \href{#method-bisbmpop-clone}{\code{bisbmpop$clone()}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-bisbmpop-new"></a>}}
\if{latex}{\out{\hypertarget{method-bisbmpop-new}{}}}
\subsection{Method \code{new()}}{
Create a new instance of the bisbmpop object

This class is generally called via the user function \code{estimate_colBiSBM}
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{bisbmpop$new(
  netlist = NULL,
  net_id = NULL,
  distribution = "bernoulli",
  free_density = FALSE,
  free_mixture_row = FALSE,
  free_mixture_col = FALSE,
  Z_init = NULL,
  global_opts = list(),
  fit_opts = list()
)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{netlist}}{The list of M networks}

\item{\code{net_id}}{A list of name for the networks, defaults to 1 to M if not
provided}

\item{\code{distribution}}{The emission distribution either "bernoulli" or
"poisson"}

\item{\code{free_density}}{If we account for different density between networks
TODO Remove}

\item{\code{free_mixture_row}}{A boolean indicating if there is free mixture on
the row blocks}

\item{\code{free_mixture_col}}{A boolean indicating if there is free mixture on
the column blocks}

\item{\code{Z_init}}{A bidimensional list providing a clustering of the row and
column nodes}

\item{\code{global_opts}}{A list of global options used by the algorithm. See
details of the user function for more information.}

\item{\code{fit_opts}}{A list of fit options used by the algorithm. See
details of the user function for more information.}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
A new 'bisbmpop' object.
A method to perform the splitting of the clusters
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-bisbmpop-split_clustering"></a>}}
\if{latex}{\out{\hypertarget{method-bisbmpop-split_clustering}{}}}
\subsection{Method \code{split_clustering()}}{
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{bisbmpop$split_clustering(origin_model, axis = "row")}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{origin_model}}{a model (fitBipartite object) to split from.}

\item{\code{axis}}{a string to indicate if this is a
column split or a row split. "row" or "col".}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
best of the possible models tested
A method to perform the merging of the clusters
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-bisbmpop-merge_clustering"></a>}}
\if{latex}{\out{\hypertarget{method-bisbmpop-merge_clustering}{}}}
\subsection{Method \code{merge_clustering()}}{
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{bisbmpop$merge_clustering(origin_model, axis = "row")}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{origin_model}}{a model (fitBipartite object) to merge from.}

\item{\code{axis}}{a string to indicate if this is a "row", "col"
or "both" merge}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
best of the possible models tested
A method to plot the state of space and its current exploration.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-bisbmpop-state_space_plot"></a>}}
\if{latex}{\out{\hypertarget{method-bisbmpop-state_space_plot}{}}}
\subsection{Method \code{state_space_plot()}}{
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{bisbmpop$state_space_plot(plot_detail = self$global_opts$plot_detail)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{plot_detail}}{Is by default set using the global options.}
}
\if{html}{\out{</div>}}
}
\subsection{Details}{
the method takes no parameters and print a plot
of the current state of the model_list.
}

\subsection{Returns}{
nothing
Method to greedily explore state of space looking for the mode
and storing the models discovered along the way
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-bisbmpop-greedy_exploration"></a>}}
\if{latex}{\out{\hypertarget{method-bisbmpop-greedy_exploration}{}}}
\subsection{Method \code{greedy_exploration()}}{
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{bisbmpop$greedy_exploration(
  starting_point,
  max_iter = 12,
  max_step_without_improvement = 2
)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{starting_point}}{A vector of the two coordinates
c(Q1,Q2) which are the starting point.}

\item{\code{max_iter}}{The maximum number of iteration of greedy exploration to
perform, defaults to 12.}

\item{\code{max_step_without_improvement}}{defaults to 2, the
number of steps to try improving before stopping the search.}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
c(Q1_mode, Q2_mode) which indicates the Q1 and Q2
for which the BICL was maximal.
Optimization from a given Z_init

The method takes no parameters
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-bisbmpop-optimize_from_zinit"></a>}}
\if{latex}{\out{\hypertarget{method-bisbmpop-optimize_from_zinit}{}}}
\subsection{Method \code{optimize_from_zinit()}}{
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{bisbmpop$optimize_from_zinit()}\if{html}{\out{</div>}}
}

\subsection{Returns}{
nothing but stores the models in the model list
Burn-in method to start exploring the state of space

The method takes no parameters but modify the object
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-bisbmpop-burn_in"></a>}}
\if{latex}{\out{\hypertarget{method-bisbmpop-burn_in}{}}}
\subsection{Method \code{burn_in()}}{
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{bisbmpop$burn_in()}\if{html}{\out{</div>}}
}

\subsection{Returns}{
nothing; but stores the values
The optimization method
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-bisbmpop-optimize"></a>}}
\if{latex}{\out{\hypertarget{method-bisbmpop-optimize}{}}}
\subsection{Method \code{optimize()}}{
This method performs the burn in (ie initialization + greedy
exploration) and the steps of moving window with cluster splitting and
merging around the mode found.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{bisbmpop$optimize()}\if{html}{\out{</div>}}
}

\subsection{Returns}{
nothing; but stores the values
The moving window application
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-bisbmpop-moving_window"></a>}}
\if{latex}{\out{\hypertarget{method-bisbmpop-moving_window}{}}}
\subsection{Method \code{moving_window()}}{
This method is a moving windows
over the Q1xQ2 space for the number of clusters
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{bisbmpop$moving_window(center, depth = 1)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{center}}{is the coordinates (Q1, Q2) in the model list of the mode}

\item{\code{depth}}{is how far away from the center
the method should be applied in a grid style
going from center - (depth,depth) to center + (depth, depth)}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
nothing; but updates the object by adding new models
To truncate the discarder model list
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-bisbmpop-truncate_discarded_model_list"></a>}}
\if{latex}{\out{\hypertarget{method-bisbmpop-truncate_discarded_model_list}{}}}
\subsection{Method \code{truncate_discarded_model_list()}}{
This method remove the worst models regarding the BICL criterion.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{bisbmpop$truncate_discarded_model_list()}\if{html}{\out{</div>}}
}

\subsection{Returns}{
nothing
Check if the point is in the limits
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-bisbmpop-point_is_in_limits"></a>}}
\if{latex}{\out{\hypertarget{method-bisbmpop-point_is_in_limits}{}}}
\subsection{Method \code{point_is_in_limits()}}{
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{bisbmpop$point_is_in_limits(point)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{point}}{A vector of size 2, containing the first coordinate Q1, the
number of row blocks and Q2 the number of column blocks.}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
A boolean if the point if in the limits of \verb{[0,Q1_max]x[0,Q2_max]}
Store the criteria and best fit
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-bisbmpop-store_criteria_and_best_fit"></a>}}
\if{latex}{\out{\hypertarget{method-bisbmpop-store_criteria_and_best_fit}{}}}
\subsection{Method \code{store_criteria_and_best_fit()}}{
This method stores the criteria (vbound, ICL, BICL) of the models
in model_list attribute and at the end choose the best model using the
BICL criterion.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{bisbmpop$store_criteria_and_best_fit()}\if{html}{\out{</div>}}
}

\subsection{Returns}{
nothing; modifies the object
Computation of the separated Bi SBM
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-bisbmpop-compute_sep_BiSBM_BICL"></a>}}
\if{latex}{\out{\hypertarget{method-bisbmpop-compute_sep_BiSBM_BICL}{}}}
\subsection{Method \code{compute_sep_BiSBM_BICL()}}{
This method performs the computation of BiSBM for each of the
network in the netlist.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{bisbmpop$compute_sep_BiSBM_BICL()}\if{html}{\out{</div>}}
}

\subsection{Returns}{
nothing; stores the values
Method to choose the collection modelisation or a separated one
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-bisbmpop-choose_joint_or_separated"></a>}}
\if{latex}{\out{\hypertarget{method-bisbmpop-choose_joint_or_separated}{}}}
\subsection{Method \code{choose_joint_or_separated()}}{
Using the BICL criterion, the best model fitted after the procedure
and the separated Bi SBM this method choose the one that maximizes the
BICL criterion.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{bisbmpop$choose_joint_or_separated()}\if{html}{\out{</div>}}
}

\subsection{Returns}{
nothing; stores a boolean
Plot method
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-bisbmpop-plot"></a>}}
\if{latex}{\out{\hypertarget{method-bisbmpop-plot}{}}}
\subsection{Method \code{plot()}}{
Plots the state space exploration
Print the vbound, the ICL and the BICL
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{bisbmpop$plot()}\if{html}{\out{</div>}}
}

}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-bisbmpop-print_metrics"></a>}}
\if{latex}{\out{\hypertarget{method-bisbmpop-print_metrics}{}}}
\subsection{Method \code{print_metrics()}}{
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{bisbmpop$print_metrics()}\if{html}{\out{</div>}}
}

\subsection{Returns}{
nothing
The message printed when one prints the object
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-bisbmpop-show"></a>}}
\if{latex}{\out{\hypertarget{method-bisbmpop-show}{}}}
\subsection{Method \code{show()}}{
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{bisbmpop$show(
  type = "Fitted Collection of Bipartite SBM\\nwith all fitted models"
)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{type}}{The title above the message.
The print method}
}
\if{html}{\out{</div>}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-bisbmpop-print"></a>}}
\if{latex}{\out{\hypertarget{method-bisbmpop-print}{}}}
\subsection{Method \code{print()}}{
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{bisbmpop$print()}\if{html}{\out{</div>}}
}

\subsection{Returns}{
nothing; prints to console
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-bisbmpop-clone"></a>}}
\if{latex}{\out{\hypertarget{method-bisbmpop-clone}{}}}
\subsection{Method \code{clone()}}{
The objects of this class are cloneable with this method.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{bisbmpop$clone(deep = FALSE)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{deep}}{Whether to make a deep clone.}
}
\if{html}{\out{</div>}}
}
}
}
