x = which.max(res$BICL) + c(- res$global_opts$depth,
res$global_opts$depth),
y = c(-Inf, 0),
fill = "gray70"
#ymax = 0, ymin = -Inf
) +
ggplot2::theme_bw()
tibble::tibble(
x = seq(length(res$BICL)),
ICL = res$ICL,
BICL = res$BICL,
vbound = res$vbound,
SBM = res$ICL_sbm) %>%
tidyr::pivot_longer(cols = -x) %>%
ggplot2::ggplot(ggplot2::aes(x = x, y = value,
linetype = name, color = name)) +
ggplot2::annotate(geom = "raster",
x = which.max(res$BICL) + c(- res$global_opts$depth,
res$global_opts$depth),
y = c(-Inf, 0),
fill = "gray70"
#ymax = 0, ymin = -Inf
) +
ggplot2::geom_line() +
ggplot2::geom_point() +
ggplot2::theme_bw()
which.max(res$BICL) + c(- res$global_opts$depth,
res$global_opts$depth)
res$global_opts$depth
tibble::tibble(
x = seq(length(res$BICL)),
ICL = res$ICL,
BICL = res$BICL,
vbound = res$vbound,
SBM = res$ICL_sbm) %>%
tidyr::pivot_longer(cols = -x) %>%
ggplot2::ggplot(ggplot2::aes(x = x, y = value,
linetype = name, color = name)) +
ggplot2::annotate(geom = "raster",
xmin = which.max(res$BICL) - res$global_opts$depth,
xmax = which.max(res$BICL) + res$global_opts$depth,                                                res$global_opts$depth),
tibble::tibble(
x = seq(length(res$BICL)),
ICL = res$ICL,
BICL = res$BICL,
vbound = res$vbound,
SBM = res$ICL_sbm) %>%
tidyr::pivot_longer(cols = -x) %>%
ggplot2::ggplot(ggplot2::aes(x = x, y = value,
linetype = name, color = name)) +
ggplot2::annotate(geom = "raster",
xmin = which.max(res$BICL) - res$global_opts$depth,
xmax = which.max(res$BICL) + res$global_opts$depth,
y = c(-Inf, 0),
fill = "gray70"
#ymax = 0, ymin = -Inf
) +
ggplot2::geom_line() +
ggplot2::geom_point() +
ggplot2::theme_bw()
tibble::tibble(
x = seq(length(res$BICL)),
ICL = res$ICL,
BICL = res$BICL,
vbound = res$vbound,
SBM = res$ICL_sbm) %>%
tidyr::pivot_longer(cols = -x) %>%
ggplot2::ggplot(ggplot2::aes(x = x, y = value,
linetype = name, color = name)) +
ggplot2::annotate(geom = "tile",
xmin = which.max(res$BICL) - res$global_opts$depth,
xmax = which.max(res$BICL) + res$global_opts$depth,
y = c(-Inf, 0),
fill = "gray70"
#ymax = 0, ymin = -Inf
) +
ggplot2::geom_line() +
ggplot2::geom_point() +
ggplot2::theme_bw()
tibble::tibble(
x = seq(length(res$BICL)),
ICL = res$ICL,
BICL = res$BICL,
vbound = res$vbound,
SBM = res$ICL_sbm) %>%
tidyr::pivot_longer(cols = -x) %>%
ggplot2::ggplot(ggplot2::aes(x = x, y = value,
linetype = name, color = name)) +
ggplot2::annotate(geom = "rect",
xmin = which.max(res$BICL) - res$global_opts$depth,
xmax = which.max(res$BICL) + res$global_opts$depth,
y = c(-Inf, 0),
fill = "gray70"
#ymax = 0, ymin = -Inf
) +
ggplot2::geom_line() +
ggplot2::geom_point() +
ggplot2::theme_bw()
tibble::tibble(
x = seq(length(res$BICL)),
ICL = res$ICL,
BICL = res$BICL,
vbound = res$vbound,
SBM = res$ICL_sbm) %>%
tidyr::pivot_longer(cols = -x) %>%
ggplot2::ggplot(ggplot2::aes(x = x, y = value,
linetype = name, color = name)) +
ggplot2::annotate(geom = "rect",
xmin = which.max(res$BICL) - res$global_opts$depth,
xmax = which.max(res$BICL) + res$global_opts$depth,
ymin = -Inf,
ymax = 0,
fill = "gray70"
#ymax = 0, ymin = -Inf
) +
ggplot2::geom_line() +
ggplot2::geom_point() +
ggplot2::theme_bw()
tibble::tibble(
x = seq(length(res$BICL)),
ICL = res$ICL,
BICL = res$BICL,
vbound = res$vbound,
SBM = res$ICL_sbm) %>%
tidyr::pivot_longer(cols = -x) %>%
ggplot2::ggplot(ggplot2::aes(x = x, y = value,
linetype = name, color = name)) +
ggplot2::annotate(geom = "rect",
xmin = which.max(res$BICL) - res$global_opts$depth,
xmax = which.max(res$BICL) + res$global_opts$depth,
ymin = -Inf,
ymax = 0,
fill = "gray90"
#ymax = 0, ymin = -Inf
) +
ggplot2::geom_line() +
ggplot2::geom_point() +
ggplot2::theme_bw()
tibble::tibble(
Q = seq(length(res$BICL)),
ICL = res$ICL,
BICL = res$BICL,
vbound = res$vbound,
SBM = res$ICL_sbm) %>%
tidyr::pivot_longer(cols = -Q) %>%
ggplot2::ggplot(ggplot2::aes(x = Q, y = value,
linetype = name, color = name)) +
ggplot2::annotate(geom = "rect",
xmin = which.max(res$BICL) - res$global_opts$depth,
xmax = which.max(res$BICL) + res$global_opts$depth,
ymin = -Inf,
ymax = 0,
fill = "gray90"
#ymax = 0, ymin = -Inf
) +
ggplot2::geom_line(size = 1.1) +
ggplot2::geom_point(size = 3) +
xlab("") +
ggplot2::theme_bw()
tibble::tibble(
Q = seq(length(res$BICL)),
ICL = res$ICL,
BICL = res$BICL,
vbound = res$vbound,
SBM = res$ICL_sbm) %>%
tidyr::pivot_longer(cols = -Q) %>%
ggplot2::ggplot(ggplot2::aes(x = Q, y = value,
linetype = name, color = name)) +
ggplot2::annotate(geom = "rect",
xmin = which.max(res$BICL) - res$global_opts$depth,
xmax = which.max(res$BICL) + res$global_opts$depth,
ymin = -Inf,
ymax = 0,
fill = "gray90"
#ymax = 0, ymin = -Inf
) +
ggplot2::geom_line(size = 1.1) +
ggplot2::geom_point(size = 3) +
ggplot2::ylab("") +
ggplot2::theme_bw()
tibble::tibble(
Q = seq(length(res$BICL)),
ICL = res$ICL,
BICL = res$BICL,
vbound = res$vbound,
SBM = res$ICL_sbm) %>%
tidyr::pivot_longer(cols = -Q, names_to = "Criterion") %>%
ggplot2::ggplot(ggplot2::aes(x = Q, y = value,
linetype = name, color = name)) +
ggplot2::annotate(geom = "rect",
xmin = which.max(res$BICL) - res$global_opts$depth,
xmax = which.max(res$BICL) + res$global_opts$depth,
ymin = -Inf,
ymax = 0,
fill = "gray90"
#ymax = 0, ymin = -Inf
) +
ggplot2::geom_line(size = 1.1) +
ggplot2::geom_point(size = 3) +
ggplot2::ylab("") +
ggplot2::theme_bw()
tibble::tibble(
Q = seq(length(res$BICL)),
ICL = res$ICL,
BICL = res$BICL,
vbound = res$vbound,
SBM = res$ICL_sbm) %>%
tidyr::pivot_longer(cols = -Q, names_to = "Criterion") %>%
ggplot2::ggplot(ggplot2::aes(x = Q, y = value,
linetype = name, color = Criterion)) +
ggplot2::annotate(geom = "rect",
xmin = which.max(res$BICL) - res$global_opts$depth,
xmax = which.max(res$BICL) + res$global_opts$depth,
ymin = -Inf,
ymax = 0,
fill = "gray90"
#ymax = 0, ymin = -Inf
) +
ggplot2::geom_line(size = 1.1) +
ggplot2::geom_point(size = 3) +
ggplot2::ylab("") +
ggplot2::theme_bw()
tibble::tibble(
Q = seq(length(res$BICL)),
ICL = res$ICL,
BICL = res$BICL,
vbound = res$vbound,
SBM = res$ICL_sbm) %>%
tidyr::pivot_longer(cols = -Q, names_to = "Criterion") %>%
ggplot2::ggplot(ggplot2::aes(x = Q, y = value,
linetype = Criterion, color = Criterion)) +
ggplot2::annotate(geom = "rect",
xmin = which.max(res$BICL) - res$global_opts$depth,
xmax = which.max(res$BICL) + res$global_opts$depth,
ymin = -Inf,
ymax = 0,
fill = "gray90"
#ymax = 0, ymin = -Inf
) +
ggplot2::geom_line(size = 1.1) +
ggplot2::geom_point(size = 3) +
ggplot2::ylab("") +
ggplot2::theme_bw()
tibble::tibble(
Q = seq(length(res$BICL)),
ICL = res$ICL,
BICL = res$BICL,
vbound = res$vbound,
SBM = res$ICL_sbm) %>%
tidyr::pivot_longer(cols = -Q, names_to = "Criterion") %>%
ggplot2::ggplot(ggplot2::aes(x = Q, y = value,
linetype = Criterion, color = Criterion,
face = Criterion)) +
ggplot2::annotate(geom = "rect",
xmin = which.max(res$BICL) - res$global_opts$depth,
xmax = which.max(res$BICL) + res$global_opts$depth,
ymin = -Inf,
ymax = 0,
fill = "gray90"
#ymax = 0, ymin = -Inf
) +
ggplot2::geom_line(size = 1.1) +
ggplot2::geom_point(size = 3) +
ggplot2::ylab("") +
ggplot2::theme_bw()
tibble::tibble(
Q = seq(length(res$BICL)),
ICL = res$ICL,
BICL = res$BICL,
vbound = res$vbound,
SBM = res$ICL_sbm) %>%
tidyr::pivot_longer(cols = -Q, names_to = "Criterion") %>%
ggplot2::ggplot(ggplot2::aes(x = Q, y = value,
linetype = Criterion, color = Criterion,
shape = Criterion)) +
ggplot2::annotate(geom = "rect",
xmin = which.max(res$BICL) - res$global_opts$depth,
xmax = which.max(res$BICL) + res$global_opts$depth,
ymin = -Inf,
ymax = 0,
fill = "gray90"
#ymax = 0, ymin = -Inf
) +
ggplot2::geom_line(size = 1.1) +
ggplot2::geom_point(size = 3) +
ggplot2::ylab("") +
ggplot2::theme_bw()
tibble::tibble(
Q = seq(length(res$BICL)),
ICL = res$ICL,
BICL = res$BICL,
vbound = res$vbound,
SBM = res$ICL_sbm) %>%
tidyr::pivot_longer(cols = -Q, names_to = "Criterion") %>%
ggplot2::ggplot(ggplot2::aes(x = Q, y = value,
linetype = Criterion, color = Criterion,
shape = Criterion)) +
ggplot2::annotate(geom = "rect",
xmin = which.max(res$BICL) - res$global_opts$depth,
xmax = which.max(res$BICL) + res$global_opts$depth,
ymin = -Inf,
ymax = .95*max(res$vbound),
fill = "gray90"
#ymax = 0, ymin = -Inf
) +
ggplot2::geom_line(size = 1.1) +
ggplot2::geom_point(size = 3) +
ggplot2::ylab("") +
ggplot2::theme_bw()
tibble::tibble(
Q = seq(length(res$BICL)),
ICL = res$ICL,
BICL = res$BICL,
vbound = res$vbound,
SBM = res$ICL_sbm) %>%
tidyr::pivot_longer(cols = -Q, names_to = "Criterion") %>%
ggplot2::ggplot(ggplot2::aes(x = Q, y = value,
linetype = Criterion, color = Criterion,
shape = Criterion)) +
ggplot2::annotate(geom = "rect",
xmin = which.max(res$BICL) - res$global_opts$depth,
xmax = which.max(res$BICL) + res$global_opts$depth,
ymin = -Inf,
ymax = .9*max(res$vbound),
fill = "gray90"
#ymax = 0, ymin = -Inf
) +
ggplot2::geom_line(size = 1.1) +
ggplot2::geom_point(size = 3) +
ggplot2::ylab("") +
ggplot2::theme_bw()
tibble::tibble(
Q = seq(length(res$BICL)),
ICL = res$ICL,
BICL = res$BICL,
vbound = res$vbound,
SBM = res$ICL_sbm) %>%
tidyr::pivot_longer(cols = -Q, names_to = "Criterion") %>%
ggplot2::ggplot(ggplot2::aes(x = Q, y = value,
linetype = Criterion, color = Criterion,
shape = Criterion)) +
ggplot2::annotate(geom = "rect",
xmin = which.max(res$BICL) - res$global_opts$depth,
xmax = which.max(res$BICL) + res$global_opts$depth,
ymin = -Inf,
ymax = Inf,
fill = "gray90"
#ymax = 0, ymin = -Inf
) +
ggplot2::geom_line(size = 1.1) +
ggplot2::geom_point(size = 3) +
ggplot2::ylab("") +
ggplot2::theme_bw()
res$Q
res$BICL
tibble::tibble(
Q = seq(length(res$BICL)),
ICL = res$ICL,
BICL = res$BICL,
vbound = res$vbound,
SBM = res$ICL_sbm) %>%
tidyr::pivot_longer(cols = -Q, names_to = "Criterion") %>%
ggplot2::ggplot(ggplot2::aes(x = Q, y = value,
linetype = Criterion, color = Criterion,
shape = Criterion)) +
ggplot2::annotate(geom = "rect",
xmin = min(which.max(res$BICL) - res$global_opts$depth, 1),
xmax = max(which.max(res$BICL) + res$global_opts$depth, length(res$BICL)),
ymin = -Inf,
ymax = Inf,
fill = "gray90"
#ymax = 0, ymin = -Inf
) +
ggplot2::geom_line(size = 1.1) +
ggplot2::geom_point(size = 3) +
ggplot2::ylab("") +
ggplot2::theme_bw()
tibble::tibble(
Q = seq(length(res$BICL)),
ICL = res$ICL,
BICL = res$BICL,
vbound = res$vbound,
SBM = res$ICL_sbm) %>%
tidyr::pivot_longer(cols = -Q, names_to = "Criterion") %>%
ggplot2::ggplot(ggplot2::aes(x = Q, y = value,
linetype = Criterion, color = Criterion,
shape = Criterion)) +
ggplot2::annotate(geom = "rect",
xmin = max(which.max(res$BICL) - res$global_opts$depth, 1),
xmax = min(which.max(res$BICL) + res$global_opts$depth, length(res$BICL)),
ymin = -Inf,
ymax = Inf,
fill = "gray90"
#ymax = 0, ymin = -Inf
) +
ggplot2::geom_line(size = 1.1) +
ggplot2::geom_point(size = 3) +
ggplot2::ylab("") +
ggplot2::theme_bw()
tibble::tibble(
Q = seq(length(res$BICL)),
ICL = res$ICL,
BICL = res$BICL,
vbound = res$vbound,
SBM = res$ICL_sbm) %>%
tidyr::pivot_longer(cols = -Q, names_to = "Criterion") %>%
ggplot2::ggplot(ggplot2::aes(x = Q, y = value,
linetype = Criterion, color = Criterion,
shape = Criterion)) +
ggplot2::annotate(geom = "rect",
xmin = max(which.max(res$BICL) - res$global_opts$depth, 1),
xmax = min(which.max(res$BICL) + res$global_opts$depth, length(res$BICL)),
ymin = -Inf,
ymax = Inf,
fill = "gray90"
#ymax = 0, ymin = -Inf
) +
ggplot2::geom_line(size = 1) +
ggplot2::geom_point(size = 3) +
ggplot2::ylab("") +
ggplot2::theme_bw()
tibble::tibble(
Q = seq(length(res$BICL)),
ICL = res$ICL,
BICL = res$BICL,
vbound = res$vbound,
SBM = res$ICL_sbm) %>%
tidyr::pivot_longer(cols = -Q, names_to = "Criterion") %>%
ggplot2::ggplot(ggplot2::aes(x = Q, y = value,
linetype = Criterion, color = Criterion,
shape = Criterion)) +
ggplot2::annotate(geom = "rect",
xmin = max(which.max(res$BICL) - res$global_opts$depth, 1),
xmax = min(which.max(res$BICL) + res$global_opts$depth, length(res$BICL)),
ymin = -Inf,
ymax = Inf,
fill = "gray90"
#ymax = 0, ymin = -Inf
) +
ggplot2::geom_line() +
ggplot2::geom_point(size = 3) +
ggplot2::ylab("") +
ggplot2::theme_bw()
res$best_fit$pred_dyads
res <- estimate_colSBM(foodwebs[4:8], colsbm_model = "pi", directed = TRUE, model = "bernoulli",
global_opts = list("verbosity" = 2,"plot_details" = 1, "Q_max" = 10L), nb_run = 1)
res <- estimate_colSBM(foodwebs[4:8], colsbm_model = "pi", directed = TRUE, model = "bernoulli",
global_opts = list("verbosity" = 2,"plot_details" = 1, "Q_max" = 10L), nb_run = 1)
library(colSBM)
tibble::tibble(
Q = seq(length(res$BICL)),
ICL = res$ICL,
BICL = res$BICL,
vbound = res$vbound,
SBM = res$ICL_sbm) %>%
tidyr::pivot_longer(cols = -Q, names_to = "Criterion") %>%
ggplot2::ggplot(ggplot2::aes(x = Q, y = value,
linetype = Criterion, color = Criterion,
shape = Criterion)) +
ggplot2::annotate(geom = "rect",
xmin = max(which.max(res$BICL) - res$global_opts$depth, 1),
xmax = min(which.max(res$BICL) + res$global_opts$depth, length(res$BICL)),
ymin = -Inf,
ymax = Inf,
fill = "gray90"
#ymax = 0, ymin = -Inf
) +
ggplot2::geom_line() +
ggplot2::geom_point(size = 3) +
ggplot2::ylab("") +
ggplot2::theme_bw()
res$best_fit$pred_dyads
res$best_fit$alpha
res$best_fit$delta
res$best_fit$delta[1] * res$best_fit$alpha
res$best_fit$tau
res$best_fit$tau[[1]]
colSBM:::.quadform(res$best_fit$tau[[1]], res$best_fit$alpha[[1]])
colSBM:::.quadform(res$best_fit$tau[[1]], res$best_fit$alpha)
library(colSBM)
library(colSBM)
library(colSBM)
library(colSBM)
devtools::document()
library(colSBM)
# Chunk 1
knitr::opts_chunk$set(
collapse = TRUE,
comment = "#>"
)
# Chunk 2: setup
library(colSBM)
library(patchwork)
data("foodwebs")
set.seed(1234)
res_fw_iid <- estimate_colSBM(netlist = foodwebs[1:3],
colsbm_model = "iid",
directed = TRUE,
net_id = names(foodwebs)[1:3],
nb_run = 1L,
global_opts = list(verbosity = 1L))
set.seed(1234)
res_fw_iid <- estimate_colSBM(netlist = foodwebs[1:3], # A list of networks
colsbm_model = "iid", # The name of the model
directed = TRUE, # Foodwebs are directed networks
net_id = names(foodwebs)[1:3], # Name of the networks
nb_run = 1L, # Nmber of runs of the algorithm
global_opts = list(verbosity = 1L,
Q_max = 8) #Max number of clusters
)
plot(res_fw_iid)
res_fw_iid$ICL_sbm
